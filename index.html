
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Falling Object Experiment</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding-top: 20px;
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
        }
        #app {
            background-color: #ffffff;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 750px;
        }
        .controls, .simulation-wrapper, .results-area, .verification-area {
            margin-bottom: 25px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        h1, h2, h3 {
            color: #1a73e8; /* Google Blue */
            margin-top: 0;
        }
        h1 { text-align: center; margin-bottom: 20px; }
        h2 { margin-bottom: 15px; }
        h3 { margin-bottom: 10px; }

        .height-options button, .action-buttons button, .results-area button, .button-group button {
            margin: 5px;
            padding: 10px 18px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            background-color: #1a73e8;
            color: white;
            font-size: 1em;
            transition: background-color 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .height-options button:hover, .action-buttons button:hover, .results-area button:hover, .button-group button:hover {
            background-color: #155ab6;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        .height-options button.selected {
            background-color: #0d47a1; /* Darker blue for selected */
            font-weight: bold;
        }
        .height-options button:disabled, .action-buttons button:disabled {
            background-color: #cccccc;
            color: #666666;
            cursor: not-allowed;
            box-shadow: none;
        }
        .simulation-wrapper {
            padding: 20px;
            background-color: #e3f2fd; /* Light blue for sky */
        }
        .simulation-area {
            position: relative;
            width: 100%;
            background-color: #bbdefb; /* Slightly darker blue for contrast */
            border-radius: 5px;
            overflow: hidden; /* Important for containing the object */
            margin: 0 auto; /* Center it if width is less than 100% */
        }
        .object-container {
            position: relative; /* Establishes positioning context for the ball */
            width: 100%;
        }
        .falling-object {
            width: 30px;
            height: 30px;
            background-color: #d32f2f; /* Red */
            border-radius: 50%;
            position: absolute;
            left: 50%;
            transform: translateX(-50%); /* Horizontally center the object */
            top: 0; /* Initial position at the top */
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .ground {
            height: 20px;
            background-color: #6d4c41; /* Brown for ground */
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            border-top: 2px solid #4e342e; /* Darker top edge for ground */
        }
        .stopwatch-display {
            font-size: 2.2em;
            font-weight: bold;
            color: #212121;
            text-align: center;
            margin: 15px 0;
            padding: 10px;
            background-color: #e0e0e0;
            border-radius: 6px;
        }
        .error-message {
            color: #c62828; /* Darker red for errors */
            background-color: #ffcdd2; /* Light red background */
            border: 1px solid #ef9a9a;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-weight: 500;
            text-align: center;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        th, td {
            border: 1px solid #d1d1d1;
            padding: 10px 12px;
            text-align: left;
        }
        th {
            background-color: #e8eaf6; /* Light Indigo */
            font-weight: 600;
            color: #3f51b5; /* Indigo */
        }
        td {
            background-color: #fff;
        }
        tr:nth-child(even) td {
            background-color: #f9f9f9;
        }
        .results-area ul {
            list-style-type: none;
            padding: 0;
        }
        .results-area ul li {
            margin-bottom: 8px;
            padding: 5px;
            border-bottom: 1px solid #eee;
        }
        .button-group {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        .trial-info {
            margin-bottom: 15px;
            font-size: 1.15em;
            text-align: center;
            color: #0d47a1;
        }
        .description-text {
            font-size: 0.95em;
            color: #555;
            margin-bottom: 10px;
        }
    </style>
<link rel="stylesheet" href="/index.css">
</head>
<body>
    <div id="app">
        <h1>Experimento de Caída Libre PPP</h1>

        <div v-if="errorMessage" class="error-message" role="alert">{{ errorMessage }}</div>

        <section class="controls" aria-labelledby="config-heading">
            <h2 id="config-heading">Configuración</h2>
            <p class="description-text">Selecciona la altura desde la cual caerá el objeto. La altura se mide en metros.</p>
            <div class="height-options" role="group" aria-label="Opciones de altura">
                <button
                    v-for="h in heightOptions"
                    :key="h"
                    @click="selectHeight(h)"
                    :class="{ selected: selectedHeight === h }"
                    :disabled="isHeightLocked"
                    :aria-pressed="selectedHeight === h"
                    aria-label="Seleccionar altura {{h}} metros">
                    {{ h }} m
                </button>
            </div>
             <p v-if="selectedHeight" class="description-text" style="margin-top:10px;">Altura seleccionada: <strong aria-live="polite">{{ selectedHeight }} m</strong></p>
        </section>

        <section class="simulation-wrapper" aria-labelledby="sim-heading">
            <h2 id="sim-heading">Simulación Visual</h2>
             <div class="simulation-area" :style="{ height: (selectedHeight ? visualDropHeight : 150) + 40 + 'px' }"> <!-- Ensure min height if no selection -->
                <div class="object-container" :style="{ height: (selectedHeight ? visualDropHeight : 150) + 'px' }">
                    <div ref="fallingObject" class="falling-object" aria-hidden="true"></div>
                </div>
                <div class="ground" aria-hidden="true"></div>
            </div>
        </section>

        <section class="controls action-buttons" aria-labelledby="exp-controls-heading">
             <h3 id="exp-controls-heading">Controles del Experimento</h3>
            <div class="trial-info" v-if="experimentStarted" aria-live="polite">
                <p>Ensayo Actual: <strong>{{ currentTrial }} / {{ maxTrials }}</strong></p>
            </div>
            <div class="stopwatch-display" aria-live="polite" aria-atomic="true">{{ stopwatch.displayTime }}</div>
            <div class="button-group">
                <button @click="startDrop" :disabled="!canStartDrop" id="startDropButton" type="button">
                    {{ objectState === 'ready' && currentTrial === 1 && !experimentStarted ? 'Iniciar Experimento' : (objectState === 'ready' ? 'Iniciar Caída' : (objectState === 'falling' ? 'Caída en Progreso...' : 'Iniciar Caída')) }}
                </button>
                <button @click="stopTimer" :disabled="!canStopTimer" id="stopTimerButton" type="button">Detener Cronómetro</button>
            </div>
            <div class="button-group">
                 <button @click="resetExperiment" id="resetButton" v-if="experimentStarted" type="button">Reiniciar Experimento</button>
            </div>
        </section>


        <section v-if="showResultsTable" class="results-area" aria-labelledby="results-heading">
            <h2 id="results-heading">Resultados de los Ensayos</h2>
            <table>
                <thead>
                    <tr>
                        <th>Ensayo</th>
                        <th>Tiempo Medido (s)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="record in measuredTimes" :key="record.trial">
                        <td>{{ record.trial }}</td>
                        <td>{{ record.time.toFixed(3) }}</td>
                    </tr>
                </tbody>
            </table>
            <div class="button-group">
                <button @click="calculateAndShowVerification" v-if="!showVerificationArea" style="margin-top: 10px;" type="button">Verificar Resultados</button>
            </div>
        </section>

        <section v-if="showVerificationArea" class="verification-area" aria-labelledby="verification-heading">
            <h3 id="verification-heading">Verificación y Análisis de Errores</h3>
            <p>Tiempo de Caída Teórico (calculado): <strong>{{ verificationData.trueFallTime.toFixed(3) }} s</strong></p>
            <p>Promedio de Tiempos Medidos: <strong>{{ verificationData.averageMeasuredTime.toFixed(3) }} s</strong></p>
            <h4>Errores por Ensayo:</h4>
            <table>
                <thead>
                    <tr>
                        <th>Ensayo</th>
                        <th>Tiempo Medido (s)</th>
                        <th>Error Absoluto (s)</th>
                        <th>Error Relativo (%)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="errorEntry in verificationData.errors" :key="errorEntry.trial">
                        <td>{{ errorEntry.trial }}</td>
                        <td>{{ errorEntry.measuredTime.toFixed(3) }}</td>
                        <td>{{ errorEntry.absoluteError.toFixed(3) }}</td>
                        <td>{{ errorEntry.relativeError.toFixed(2) }} %</td>
                    </tr>
                </tbody>
            </table>
            <p>Promedio de Error Absoluto: <strong>{{ verificationData.averageAbsoluteError.toFixed(3) }} s</strong></p>
            <p>Promedio de Error Relativo: <strong>{{ verificationData.averageRelativeError.toFixed(2) }} %</strong></p>
        </section>

    </div>

    <script type="module" src="./index.js"></script>
<script type="module" src="/index.tsx"></script>
</body>
</html>
